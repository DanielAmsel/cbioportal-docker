# Build image with changes in portal.properties

When building an image on which to run containers, the Dockerfile adjusts configuration files by applying patches to them. The main cBioPortal configuration file is `/cbioportal/src/main/resources/portal.properties`, which is generated by patching `/cbioportal/src/main/resources/portal.properties` with `portal.properties.patch`. To build an image that uses different settings (see the documentation on the [main properties](https://github.com/cBioPortal/cbioportal/blob/master/docs/portal.properties-Reference.md) and the [skin properties](https://github.com/cBioPortal/cbioportal/blob/master/docs/Customizing-your-instance-of-cBioPortal.md)), you can follow the steps listed below.

### Step 1: modify `portal.properties` in the cBioPortal Docker directory
First, the  `portal.properties.EXAMPLE` of the current version of cBioPortal listed in the `Dockerfile` must be downloaded twice in the `cbioportal-docker` folder. This can be done by following these commands:

```
cd cbioportal-docker-repository
wget https://raw.githubusercontent.com/cBioPortal/cbioportal/v1.2.5/src/main/resources/portal.properties.EXAMPLE -O portal.properties
wget https://raw.githubusercontent.com/cBioPortal/cbioportal/v1.2.5/src/main/resources/portal.properties.EXAMPLE -O portal.properties.EXAMPLE
```

:warning: **Attention**: These commands assume you are using version 1.2.5 from cBioPortal. If you use a different version, replace `v1.2.5` by your version number.

Once the files are downloaded, you can modify the `portal.properties` and continue with step 2 below. 

### Step 2: generate a new `portal.properties.patch`

To create the `portal.properties.patch`, you should ensure that you are in your cBioPortal Docker directory and type the following command:

```
diff -u portal.properties.EXAMPLE portal.properties > portal.properties.patch
```

### Step 3: build the new Docker image

Once you have done your changes, you can build the image by going to your cBioPortal Docker directory and typing:

```
docker build -t cbioportal-image .
```
